# argstore

The argstore module is an argparse wrapper and replacement designed to store execution options and write them as metadata stings to output text files or logs.

The module contain `ArgumentParser` class, a wrapper of the original `argparse.ArgumentParser`, which has several additional methods and some extra arguments in its constructor, `add_argument()`, `add_argument_group()`, and `add_mutually_exclusive_group()` methods. These additional arguments allow to format the resulted metadata message.

## Example

```python
import argstore

parser = argstore.ArgumentParser(prog="Example script")
parser.add_argument("-f", "--foo", help="argument foo")
parser.add_argument("-b", "--bar", help="argument bar")
args = parser.parse_args()

values = parser.prepare_values(args)
template = parser.prepare_template()
metadata = template.format(**values)

print(metadata)
```

The module store formatting for arguments and argument containers. The latter include parser objects and argument groups. Mutually exclusive groups do not create new argument containers by default, they use the parent container to store arguments and groups.

## Create parser

*class* **ArgumentParser()**

This class contain the same arguments as the original `argparse.ArgumentParser` and some additional meta_* arguments.

* meta_title = `str`, default is "### {meta_name}"
* meta_name = `str`, default is either `prog` or `sys.argv[0]` value
* meta_tag = `str`, default is "## "

## Prepare metadata template

**ArgumentParser.prepare_template()**

The method returns a template string of the output metadata message. The string is ready for filling with `format()` method. Argument values should be passed as named arguments.

```python
args = parser.parse_args()
template = parser.prepare_template()
template.format(**vars(args))
```

## Prepare argument values

**ArgumentParser.prepare_values(namespace)**

The method gets the populated namespace generated by `parse_args()` method and returns a dict object which contain preformatted values by corresponding meta_formatter (if it was specified in `add_argument()` call).

```python
args = parser.parse_args()
template = parser.prepare_template()
values = parser.prepare_values(args)
template.format(**values)
```

The only purpose of this method is application of the meta_formatters stored during parser filling with arguments and argument groups.

